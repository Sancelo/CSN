@page "/register"
@using CSN.Models
@inject dbCSNChatContext dbcontext
@inject NavigationManager Navigation
@using Microsoft.EntityFrameworkCore
@rendermode InteractiveServer

<PageTitle>Đăng ký tài khoản</PageTitle>
<style>
    .background {
        background-image: url('images/nenlogin.jpg'); /* Đường dẫn tới hình ảnh trong thư mục wwwroot */
        background-size: cover;
        background-position: center;
        height: 100vh;
        width: 100vw;
        position: fixed;
        top: 0;
        left: 0;
        z-index: -1;
        opacity: 0.75;
    }

    .main-content {
        position: relative;
        z-index: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }

    .content {
        background: linear-gradient(to bottom right, #ffffffdd, #f0f0f0dd); /* Nền mờ chuyển sắc */
        padding: 40px;
        border-radius: 15px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2); /* Đổ bóng cho hộp */
        width: 100%;
        max-width: 400px;
        
        
    }

        .content h3 {
            font-size: 24px;
            text-align:center;
            margin-bottom: 20px;
            color:  #54A2FF;
        }

    .form-group {
        margin-bottom: 20px;
    }

        .form-group label {
            
            color: #555;
            display: block;
            margin-bottom: 5px;
        }

    .form-control {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 14px;
    }

        .form-control:focus {
            outline: none;
            border-color: #007bff; /* Màu viền khi focus */
            box-shadow: 0 0 4px rgba(0, 123, 255, 0.3);
        }

    .btn-primary {
        background-color: #007bff;
        color: #fff;
        padding: 10px 15px;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        width: 100%;
        transition: background-color 0.3s;
    }

        .btn-primary:hover {
            background-color: #0056b3;
        }

    .register-link {
        margin-top: 20px;
    }

        .register-link a {
            color: #007bff;
            text-decoration: none;
            f
        }

            .register-link a:hover {
                text-decoration: underline;
            }
</style>


<div class="background"></div> <!-- Div cho lớp nền -->

<div class="main-content">
    <div class="content">
        <h3>ĐĂNG KÝ TÀI KHOẢN</h3>

        <EditForm Model="@user" OnValidSubmit="HandleRegister">
            <DataAnnotationsValidator />
            <ValidationSummary />

            <div class="form-group">
                <label for="email">Email</label>
                <InputText id="username" class="form-control" @bind-Value="user.Email" placeholder="nguyenvanb@gmail..."/>
                <ValidationMessage For="() => user.Email" />
            </div>

            <div class="form-group">
                <label for="username">Tên người dùng</label>
                <InputText id="username" class="form-control" @bind-Value="user.UserName" placeholder="Biệt danh..."/>
                <ValidationMessage For="() => user.UserName" />
            </div>

            <div class="form-group">
                <label for="password">Mật khẩu</label>
                <InputText id="password" type="password" class="form-control" @bind-Value="user.PassWord" placeholder="Mật khẩu..."/>
                <ValidationMessage For="() => user.PassWord" />
            </div>

            <div class="form-group">
                <label for="confirmPassword">Xác nhận mật khẩu</label>
                <InputText id="confirmPassword" type="password" class="form-control" @bind-Value="confirmPassword" placeholder="Xác nhận mật khẩu..."/>
                <ValidationMessage For="() => confirmPassword" />
            </div>

            <button type="submit" class="btn btn-primary">Đăng ký</button>
        </EditForm>

        <div class="register-link">
            <span>Đã có tài khoản?</span>
            <a href="/">Đăng nhập tại đây</a>
        </div>
    </div>
</div>

@code {
    private tbUser user = new tbUser();
    private string confirmPassword = string.Empty;

    private async Task HandleRegister()
    {
        if (user.PassWord != confirmPassword)
        {
            // Thông báo lỗi nếu mật khẩu và xác nhận mật khẩu không khớp
            // Bạn có thể thêm thông báo lỗi tại đây
            return;
        }

        dbcontext.Users.Add(user);
        await dbcontext.SaveChangesAsync();

        Navigation.NavigateTo("/"); // Chuyển về trang đăng nhập sau khi đăng ký thành công
    }
}